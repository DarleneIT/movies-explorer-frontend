{"ast":null,"code":"var _jsxFileName = \"/Users/darlene/Desktop/dev/diploma/movies-explorer-frontend/frontend/src/components/Movies/Movies.js\",\n  _s = $RefreshSig$();\n//Реакт\nimport React, { useEffect, useCallback, useState } from \"react\";\n\n//Компоненты\nimport Header from \"../Header/Header.js\";\nimport SearchForm from \"./SearchForm/SearchForm.js\";\nimport MoviesCardList from \"./MoviesCardList/MoviesCardList.js\";\nimport Footer from \"../Footer/Footer.jsx\";\n\n//Стили\nimport \"./Movies.css\";\n\n//Апи\nimport moviesApi from \"../../utils/MoviesApi.js\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nfunction Movies({\n  isLoggedIn,\n  savedMovies,\n  onLike,\n  onDislike\n}) {\n  _s();\n  const [isLoading, setIsLoading] = useState(false);\n  const [filteredMovies, setFilteredMovies] = useState([]);\n  const [initialCardsMovies, setInitialCardsMovies] = useState([]);\n  const [isShortMovies, setisShortMovies] = useState(false);\n  const [isReqError, setisReqError] = useState(false);\n  const [isNotFound, setIsNotFound] = useState(false);\n  function convertMovieDuration(duration) {\n    const minutes = duration % 60;\n    const hours = Math.floor(duration / 60);\n    return `${hours}ч${minutes}м`;\n  }\n  function searchMovies(query) {\n    localStorage.setItem(\"movieSearch\", query);\n    localStorage.setItem(\"shortMovies\", isShortMovies);\n    if (localStorage.getItem(\"allMovies\")) {\n      const movies = JSON.parse(localStorage.getItem(\"allMovies\"));\n      handleFilterMovie(movies, query, isShortMovies);\n    } else {\n      setIsLoading(true);\n      moviesApi.getMovies().then(cardsSavedFilms => {\n        handleFilterMovie(cardsSavedFilms, query, isShortMovies);\n        setisReqError(false);\n      }).catch(error => {\n        setisReqError(true);\n        console.log(error);\n      }).finally(() => {\n        setIsLoading(false);\n      });\n    }\n  }\n\n  //Из полезного\n  function counterDurationMovie(movies) {\n    return movies.filter(movie => movie.duration < MAX_DURATION_MOVIE);\n  }\n  function filterMovies(movies, query) {\n    const moviesQuery = movies.filter(movie => {\n      const movieRu = String(movie.nameRU).toLowerCase().trim();\n      const movieEn = String(movie.nameEN).toLowerCase().trim();\n      const userQuery = query.toLowerCase().trim();\n      return movieRu.indexOf(userQuery) !== -1 || movieEn.indexOf(userQuery) !== -1;\n    });\n    return moviesQuery;\n  }\n\n  //\n\n  function shortMoviesToggle() {\n    setisShortMovies(!isShortMovies);\n    if (!isShortMovies) {\n      const filteredCardsMovies = counterDurationMovie(initialCardsMovies);\n      setFilteredMovies(filteredCardsMovies);\n    } else {\n      setFilteredMovies(initialCardsMovies);\n    }\n    localStorage.setItem(\"shortMovies\", !isShortMovies);\n  }\n\n  // Функция фильтрации фильмов\n  function handleFilterMovie(movies, query, short) {\n    const moviesFilmList = filterMovies(movies, query, short);\n    setInitialCardsMovies(moviesFilmList);\n    setFilteredMovies(short ? counterDurationMovie(moviesFilmList) : moviesFilmList);\n    localStorage.setItem(\"movies\", JSON.stringify(moviesFilmList));\n    localStorage.setItem(\"allMovies\", JSON.stringify(movies));\n  }\n\n  // Получение короткометражных фильмов\n  useEffect(() => {\n    setisShortMovies(localStorage.getItem(\"shortMovies\") === \"true\");\n  }, []);\n\n  // Получение фильмов из localStorage\n  useEffect(() => {\n    if (localStorage.getItem(\"movies\")) {\n      const movies = JSON.parse(localStorage.getItem(\"movies\"));\n      setInitialCardsMovies(movies);\n      if (localStorage.getItem(\"shortMovies\") === \"true\") {\n        setFilteredMovies(counterDurationMovie(movies));\n      } else {\n        setFilteredMovies(movies);\n      }\n    }\n  }, []);\n  useEffect(() => {\n    if (localStorage.getItem(\"movieSearch\")) {\n      setIsNotFound(filteredMovies.length === 0);\n    } else {\n      setIsNotFound(false);\n    }\n  }, [filteredMovies]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Header, {\n      isLoggedIn: isLoggedIn\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n      className: \"movies\",\n      children: [/*#__PURE__*/_jsxDEV(SearchForm, {\n        isShortMovies: isShortMovies,\n        onFilterMovies: shortMoviesToggle,\n        searchMovies: searchMovies\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(MoviesCardList, {\n        cards: filteredMovies,\n        isLoading: isLoading,\n        isSavedFilms: false,\n        savedMovies: savedMovies,\n        isReqError: isReqError,\n        onLike: onLike,\n        onDislike: onDislike,\n        isNotFound: isNotFound\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"movies__button\",\n        type: \"button\",\n        children: \"\\u0415\\u0449\\u0451\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Footer, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\n_s(Movies, \"dwfQkV0e4aNHLS6tcG2A1UsnlEg=\");\n_c = Movies;\nexport default Movies;\nvar _c;\n$RefreshReg$(_c, \"Movies\");","map":{"version":3,"names":["React","useEffect","useCallback","useState","Header","SearchForm","MoviesCardList","Footer","moviesApi","jsxDEV","_jsxDEV","Fragment","_Fragment","Movies","isLoggedIn","savedMovies","onLike","onDislike","_s","isLoading","setIsLoading","filteredMovies","setFilteredMovies","initialCardsMovies","setInitialCardsMovies","isShortMovies","setisShortMovies","isReqError","setisReqError","isNotFound","setIsNotFound","convertMovieDuration","duration","minutes","hours","Math","floor","searchMovies","query","localStorage","setItem","getItem","movies","JSON","parse","handleFilterMovie","getMovies","then","cardsSavedFilms","catch","error","console","log","finally","counterDurationMovie","filter","movie","MAX_DURATION_MOVIE","filterMovies","moviesQuery","movieRu","String","nameRU","toLowerCase","trim","movieEn","nameEN","userQuery","indexOf","shortMoviesToggle","filteredCardsMovies","short","moviesFilmList","stringify","length","children","fileName","_jsxFileName","lineNumber","columnNumber","className","onFilterMovies","cards","isSavedFilms","type","_c","$RefreshReg$"],"sources":["/Users/darlene/Desktop/dev/diploma/movies-explorer-frontend/frontend/src/components/Movies/Movies.js"],"sourcesContent":["//Реакт\nimport React, { useEffect, useCallback, useState } from \"react\";\n\n//Компоненты\nimport Header from \"../Header/Header.js\";\nimport SearchForm from \"./SearchForm/SearchForm.js\";\nimport MoviesCardList from \"./MoviesCardList/MoviesCardList.js\";\nimport Footer from \"../Footer/Footer.jsx\";\n\n//Стили\nimport \"./Movies.css\";\n\n//Апи\nimport moviesApi from \"../../utils/MoviesApi.js\";\n\nfunction Movies({ isLoggedIn, savedMovies, onLike, onDislike }) {\n  const [isLoading, setIsLoading] = useState(false);\n  const [filteredMovies, setFilteredMovies] = useState([]);\n  const [initialCardsMovies, setInitialCardsMovies] = useState([]);\n  const [isShortMovies, setisShortMovies] = useState(false);\n  const [isReqError, setisReqError] = useState(false);\n  const [isNotFound, setIsNotFound] = useState(false);\n\n  function convertMovieDuration(duration) {\n    const minutes = duration % 60;\n    const hours = Math.floor(duration / 60);\n    return `${hours}ч${minutes}м`;\n  }\n\n  function searchMovies(query) {\n    localStorage.setItem(\"movieSearch\", query);\n    localStorage.setItem(\"shortMovies\", isShortMovies);\n    if (localStorage.getItem(\"allMovies\")) {\n      const movies = JSON.parse(localStorage.getItem(\"allMovies\"));\n      handleFilterMovie(movies, query, isShortMovies);\n    } else {\n      setIsLoading(true);\n      moviesApi\n        .getMovies()\n        .then((cardsSavedFilms) => {\n          handleFilterMovie(cardsSavedFilms, query, isShortMovies);\n          setisReqError(false);\n        })\n        .catch((error) => {\n          setisReqError(true);\n          console.log(error);\n        })\n        .finally(() => {\n          setIsLoading(false);\n        });\n    }\n  }\n\n  //Из полезного\n  function counterDurationMovie(movies) {\n    return movies.filter((movie) => movie.duration < MAX_DURATION_MOVIE);\n  }\n\n  function filterMovies(movies, query) {\n    const moviesQuery = movies.filter((movie) => {\n      const movieRu = String(movie.nameRU).toLowerCase().trim();\n      const movieEn = String(movie.nameEN).toLowerCase().trim();\n      const userQuery = query.toLowerCase().trim();\n      return (\n        movieRu.indexOf(userQuery) !== -1 || movieEn.indexOf(userQuery) !== -1\n      );\n    });\n    return moviesQuery;\n  }\n\n  //\n\n  function shortMoviesToggle() {\n    setisShortMovies(!isShortMovies);\n    if (!isShortMovies) {\n      const filteredCardsMovies = counterDurationMovie(initialCardsMovies);\n      setFilteredMovies(filteredCardsMovies);\n    } else {\n      setFilteredMovies(initialCardsMovies);\n    }\n    localStorage.setItem(\"shortMovies\", !isShortMovies);\n  }\n\n  // Функция фильтрации фильмов\n  function handleFilterMovie(movies, query, short) {\n    const moviesFilmList = filterMovies(movies, query, short);\n    setInitialCardsMovies(moviesFilmList);\n    setFilteredMovies(\n      short ? counterDurationMovie(moviesFilmList) : moviesFilmList\n    );\n    localStorage.setItem(\"movies\", JSON.stringify(moviesFilmList));\n    localStorage.setItem(\"allMovies\", JSON.stringify(movies));\n  }\n\n  // Получение короткометражных фильмов\n  useEffect(() => {\n    setisShortMovies(localStorage.getItem(\"shortMovies\") === \"true\");\n  }, []);\n\n  // Получение фильмов из localStorage\n  useEffect(() => {\n    if (localStorage.getItem(\"movies\")) {\n      const movies = JSON.parse(localStorage.getItem(\"movies\"));\n      setInitialCardsMovies(movies);\n      if (localStorage.getItem(\"shortMovies\") === \"true\") {\n        setFilteredMovies(counterDurationMovie(movies));\n      } else {\n        setFilteredMovies(movies);\n      }\n    }\n  }, []);\n\n  useEffect(() => {\n    if (localStorage.getItem(\"movieSearch\")) {\n      setIsNotFound(filteredMovies.length === 0);\n    } else {\n      setIsNotFound(false);\n    }\n  }, [filteredMovies]);\n\n  return (\n    <>\n      <Header isLoggedIn={isLoggedIn} />\n      <main className=\"movies\">\n        <SearchForm\n          isShortMovies={isShortMovies}\n          onFilterMovies={shortMoviesToggle}\n          searchMovies={searchMovies}\n        />\n        <MoviesCardList\n          cards={filteredMovies}\n          isLoading={isLoading}\n          isSavedFilms={false}\n          savedMovies={savedMovies}\n          isReqError={isReqError}\n          onLike={onLike}\n          onDislike={onDislike}\n          isNotFound={isNotFound}\n        />\n        <button className=\"movies__button\" type=\"button\">\n          Ещё\n        </button>\n      </main>\n      <Footer />\n    </>\n  );\n}\n\nexport default Movies;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}