{"ast":null,"code":"var _jsxFileName = \"/Users/darlene/Desktop/dev/diploma/movies-explorer-frontend/frontend/src/components/Movies/Movies.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useCallback, useState } from \"react\";\nimport Header from \"../Header/Header.js\";\nimport SearchForm from \"./SearchForm/SearchForm.js\";\nimport MoviesCardList from \"./MoviesCardList/MoviesCardList.js\";\nimport Footer from \"../Footer/Footer.jsx\";\nimport \"./Movies.css\";\nimport moviesApi from \"../../utils/MoviesApi.js\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nfunction Movies({\n  isLoggedIn,\n  setIsError,\n  addMovie,\n  savedMovies\n}) {\n  _s();\n  const [allMovies, setAllMovies] = useState([]);\n  const [filteredMovies, setFilteredMovies] = useState([]);\n  const [searchedMouvie, setSearchedMovie] = useState('');\n  const [isCheck, setIsCheck] = useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n  const [serverError, setServerError] = useState(false);\n  const [firstEntrance, setFirstEntrance] = useState(true);\n  const filter = useCallback((search, isCheck, movies) => {\n    localStorage.setItem('movie', JSON.stringify(search));\n    localStorage.setItem('shorts', JSON.stringify(isCheck));\n    localStorage.setItem('allmovies', JSON.stringify(movies));\n    setFilteredMovies(movies.filter(movie => {\n      const searchName = movie.nameRU.toLowerCase().includes(search.toLowerCase());\n      return isCheck ? searchName && movie.duration <= 40 : searchName;\n    }));\n  }, []);\n  function searchMovies(search) {\n    if (allMovies.length === 0) {\n      setIsLoading(true);\n      moviesApi.getMovies().then(res => {\n        setAllMovies(res);\n        setIsCheck(false);\n        setServerError(false);\n        setFirstEntrance(false);\n        filter(search, isCheck, res);\n      }).catch(err => {\n        setServerError(true);\n        console.error(`Ошибка при поиске фильмов ${err}`);\n      }).finally(() => setIsLoading(false));\n    } else {\n      filter(search, isCheck, allMovies);\n    }\n  }\n  useEffect(() => {\n    if (localStorage.allmovies && localStorage.shorts && localStorage.movie) {\n      const movies = JSON.parse(localStorage.allmovies);\n      const search = JSON.parse(localStorage.movie);\n      const isCheck = JSON.parse(localStorage.shorts);\n      setServerError(false);\n      setFirstEntrance(false);\n      setSearchedMovie(search);\n      setIsCheck(isCheck);\n      setAllMovies(movies);\n      filter(search, isCheck, movies);\n    }\n  }, [filter]);\n  function changeShort() {\n    if (isCheck) {\n      setIsCheck(false);\n      filter(searchedMouvie, false, allMovies);\n      localStorage.setItem('shorts', JSON.stringify(false));\n    } else {\n      setIsCheck(true);\n      filter(searchedMouvie, true, allMovies);\n      localStorage.setItem('shorts', JSON.stringify(true));\n    }\n  }\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Header, {\n      isLoggedIn: isLoggedIn\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n      className: \"movies\",\n      children: [/*#__PURE__*/_jsxDEV(SearchForm, {\n        isCheck: isCheck,\n        searchMovies: searchMovies,\n        searchedMovie: searchedMouvie,\n        changeShort: changeShort,\n        setIsError: setIsError,\n        firstEntrance: firstEntrance\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(MoviesCardList, {\n        movies: filteredMovies,\n        addMovie: addMovie,\n        savedMovies: savedMovies,\n        isLoading: isLoading,\n        serverError: serverError,\n        firstEntrance: firstEntrance\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"movies__button\",\n        type: \"button\",\n        children: \"\\u0415\\u0449\\u0451\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(Footer, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 5\n    }, this)]\n  }, void 0, true);\n}\n_s(Movies, \"xDcDdTImrKp/MF9tDZ7nHwAJlGU=\");\n_c = Movies;\nexport default Movies;\nvar _c;\n$RefreshReg$(_c, \"Movies\");","map":{"version":3,"names":["React","useEffect","useCallback","useState","Header","SearchForm","MoviesCardList","Footer","moviesApi","jsxDEV","_jsxDEV","Fragment","_Fragment","Movies","isLoggedIn","setIsError","addMovie","savedMovies","_s","allMovies","setAllMovies","filteredMovies","setFilteredMovies","searchedMouvie","setSearchedMovie","isCheck","setIsCheck","isLoading","setIsLoading","serverError","setServerError","firstEntrance","setFirstEntrance","filter","search","movies","localStorage","setItem","JSON","stringify","movie","searchName","nameRU","toLowerCase","includes","duration","searchMovies","length","getMovies","then","res","catch","err","console","error","finally","allmovies","shorts","parse","changeShort","children","fileName","_jsxFileName","lineNumber","columnNumber","className","searchedMovie","type","_c","$RefreshReg$"],"sources":["/Users/darlene/Desktop/dev/diploma/movies-explorer-frontend/frontend/src/components/Movies/Movies.js"],"sourcesContent":["import React, { useEffect, useCallback, useState } from \"react\";\n\nimport Header from \"../Header/Header.js\";\nimport SearchForm from \"./SearchForm/SearchForm.js\";\nimport MoviesCardList from \"./MoviesCardList/MoviesCardList.js\";\nimport Footer from \"../Footer/Footer.jsx\";\n\nimport \"./Movies.css\";\n\nimport moviesApi from \"../../utils/MoviesApi.js\"\n\n\nfunction Movies({ isLoggedIn, setIsError, addMovie, savedMovies }) {\n\n  const [allMovies, setAllMovies] = useState([])\n  const [filteredMovies, setFilteredMovies] = useState([])\n  const [searchedMouvie, setSearchedMovie] = useState('')\n  const [isCheck, setIsCheck] = useState(false)\n  const [isLoading, setIsLoading] = useState(false)\n  const [serverError, setServerError] = useState(false)\n  const [firstEntrance, setFirstEntrance] = useState(true)\n\n  const filter = useCallback((search, isCheck, movies) => {\n    localStorage.setItem('movie', JSON.stringify(search))\n    localStorage.setItem('shorts', JSON.stringify(isCheck))\n    localStorage.setItem('allmovies', JSON.stringify(movies))\n    setFilteredMovies(movies.filter((movie) => {\n      const searchName = movie.nameRU.toLowerCase().includes(search.toLowerCase())\n      return isCheck ? (searchName && movie.duration <= 40) : searchName\n    }))\n  }, [])\n\n  function searchMovies(search) {\n    if (allMovies.length === 0) {\n      setIsLoading(true)\n      moviesApi.getMovies()\n        .then((res) => {\n          setAllMovies(res)\n          setIsCheck(false)\n          setServerError(false)\n          setFirstEntrance(false)\n          filter(search, isCheck, res)\n        })\n        .catch(err => {\n          setServerError(true)\n          console.error(`Ошибка при поиске фильмов ${err}`)\n        })\n        .finally(() => setIsLoading(false))\n    } else {\n      filter(search, isCheck, allMovies)\n    }\n  }\n\n  useEffect(() => {\n    if (localStorage.allmovies && localStorage.shorts && localStorage.movie) {\n      const movies = JSON.parse(localStorage.allmovies)\n      const search = JSON.parse(localStorage.movie)\n      const isCheck = JSON.parse(localStorage.shorts)\n      setServerError(false)\n      setFirstEntrance(false)\n      setSearchedMovie(search)\n      setIsCheck(isCheck)\n      setAllMovies(movies)\n      filter(search, isCheck, movies)\n    }\n  }, [filter])\n\n  function changeShort() {\n    if (isCheck) {\n      setIsCheck(false)\n      filter(searchedMouvie, false, allMovies)\n      localStorage.setItem('shorts', JSON.stringify(false))\n    } else {\n      setIsCheck(true)\n      filter(searchedMouvie, true, allMovies)\n      localStorage.setItem('shorts', JSON.stringify(true))\n    }\n  }\n\n  return (\n    <> \n    <Header isLoggedIn={isLoggedIn} />\n    <main className=\"movies\">\n      <SearchForm \n      isCheck={isCheck}\n      searchMovies={searchMovies}\n      searchedMovie={searchedMouvie}\n      changeShort={changeShort}\n      setIsError={setIsError}\n      firstEntrance={firstEntrance}\n      />\n      <MoviesCardList \n      movies={filteredMovies}\n      addMovie={addMovie}\n      savedMovies={savedMovies}\n      isLoading={isLoading}\n      serverError={serverError}\n      firstEntrance={firstEntrance}\n      />\n      <button className=\"movies__button\" type=\"button\">\n        Ещё\n      </button>\n    </main>\n    <Footer />\n    </>\n  );\n}\n\nexport default Movies;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}